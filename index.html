import React, { useState } from 'react';
import { Calendar, Activity, Heart, Moon, Utensils, Droplets, MessageCircle, TrendingUp, Award, AlertCircle } from 'lucide-react';

const HealthRoutineApp = () => {
  const [activeTab, setActiveTab] = useState('tracker');
  const [routineData, setRoutineData] = useState({
    sleepHours: 7,
    waterIntake: 6,
    meals: 3,
    exercise: 30,
    screenTime: 4,
    stressLevel: 5
  });
  const [chatMessages, setChatMessages] = useState([
    { type: 'bot', text: "ü™Ñ Greetings, young wizard! I am the Sorting Hat of Health, here to guide you on your wellness journey. What magical health wisdom do you seek today?" }
  ]);
  const [chatInput, setChatInput] = useState('');
  const [visitorCount] = useState(() => {
    return Math.floor(Math.random() * 500 + 100);
  });

  const calculateHealthScore = () => {
    let score = 0;
    if (routineData.sleepHours >= 7 && routineData.sleepHours <= 9) score += 20;
    else if (routineData.sleepHours >= 6) score += 15;
    else score += 5;
    
    if (routineData.waterIntake >= 8) score += 20;
    else if (routineData.waterIntake >= 6) score += 15;
    else score += 8;
    
    if (routineData.meals >= 3) score += 15;
    else score += 10;
    
    if (routineData.exercise >= 30) score += 25;
    else if (routineData.exercise >= 15) score += 15;
    else score += 5;
    
    if (routineData.screenTime <= 2) score += 15;
    else if (routineData.screenTime <= 4) score += 10;
    else score += 3;
    
    if (routineData.stressLevel <= 3) score += 5;
    else if (routineData.stressLevel <= 6) score += 3;
    else score += 1;
    
    return score;
  };

  const getFeedback = () => {
    const feedback = [];
    
    if (routineData.sleepHours < 7) {
      feedback.push({
        icon: Moon,
        color: 'text-red-500',
        title: '‚ö° Dark Magic Detected in Your Sleep Chamber!',
        text: `Merlin's beard! Only ${routineData.sleepHours} hours? Even Hermione needs 7-9 hours to master her spells! Professor McGonagall prescribes: a consistent bedtime (no midnight wandering!), a dark room like the Slytherin dungeons, and banish all Muggle screens an hour before bed. Remember, even Harry needed proper rest to defeat You-Know-Who!`
      });
    } else if (routineData.sleepHours > 9) {
      feedback.push({
        icon: Moon,
        color: 'text-yellow-500',
        title: 'üí§ Sleeping Like a Stunned Hippogriff',
        text: 'By Dumbledore\'s wisdom! Over 9 hours might mean something\'s brewing in your cauldron. Quality beats quantity - even a Time-Turner won\'t help if the sleep isn\'t restorative. Consider consulting Madam Pomfrey if this persists!'
      });
    } else {
      feedback.push({
        icon: Moon,
        color: 'text-green-500',
        title: '‚ú® Excellent! 10 Points to Your House!',
        text: 'Brilliant! Your sleep schedule would make even Professor Snape nod with approval (though he\'d never admit it). This is the kind of rest that helps wizards stay sharp for O.W.L.s and N.E.W.T.s! Keep up this magical routine!'
      });
    }
    
    if (routineData.waterIntake < 8) {
      feedback.push({
        icon: Droplets,
        color: 'text-blue-400',
        title: 'üßô Aguamenti! Your Hydration Spell is Weak',
        text: `Dear wizard, ${routineData.waterIntake} glasses? Even a drought charm is more effective! The wise Dumbledore targets 8+ glasses daily. Pro tips: Start with water upon waking (like Felix Felicis for your day!), keep a bottle as faithful as a wand, and set hourly reminders. Remember, even Dobby knew to stay hydrated!`
      });
    } else {
      feedback.push({
        icon: Droplets,
        color: 'text-green-500',
        title: 'üíß Hydration Charm Successfully Cast!',
        text: 'Marvelous! Your water intake rivals the Great Lake at Hogwarts! This potion supports your inner magic - better digestion than Slughorn\'s potions, skin as radiant as Fleur Delacour, and energy to rival a Golden Snitch! Keep this spell going!'
      });
    }
    
    if (routineData.exercise < 30) {
      feedback.push({
        icon: Activity,
        color: 'text-orange-500',
        title: 'üèÉ Expelliarmus Your Couch Habit!',
        text: `${routineData.exercise} minutes is like practicing one spell when you need a full arsenal! Aim for 30+ minutes daily, young wizard. Try: brisk walking through the Forbidden Forest (or your neighborhood), climbing stairs like you're racing to Gryffindor Tower, dancing like at the Yule Ball, or quick workouts worthy of Quidditch training!`
      });
    } else {
      feedback.push({
        icon: Activity,
        color: 'text-green-500',
        title: 'üèÜ Quidditch Champion Level Fitness!',
        text: 'Outstanding! You\'re moving like a Seeker chasing the Snitch! This level of activity boosts your mood better than Butterbeer, gives energy rivaling a Patronus charm, and ensures long-term health worthy of living 100 magical years! The Weasley twins would be proud!'
      });
    }
    
    if (routineData.screenTime > 4) {
      feedback.push({
        icon: AlertCircle,
        color: 'text-purple-500',
        title: 'üì± Warning: Muggle Device Overexposure!',
        text: `${routineData.screenTime} hours staring at Muggle devices? Even the Mirror of Erised should be used in moderation! Reduce to under 4 hours. Try the 20-20-20 charm: every 20 minutes, gaze 20 feet away for 20 seconds. Or better yet, read a spell book, practice wandwork outdoors, or visit Hogsmeade (your local park)!`
      });
    }
    
    if (routineData.stressLevel > 6) {
      feedback.push({
        icon: Heart,
        color: 'text-red-400',
        title: '‚ö° Dementor Alert: Stress Level Critical!',
        text: 'By Merlin\'s most baggy trousers! High stress detected - time to cast your Patronus! Practice: Deep breathing (the 4-7-8 charm works wonders), 10 minutes of meditation (like practicing Occlumency), journaling your thoughts (as therapeutic as Tom Riddle\'s diary, but safer!), or confide in a trusted friend like Harry had Ron and Hermione. You\'ve got this, brave wizard!'
      });
    }
    
    return feedback;
  };

  const getAIResponse = (message) => {
    const msg = message.toLowerCase();
    
    if (msg.includes('sleep') || msg.includes('tired') || msg.includes('insomnia')) {
      return "üåô Ah, seeking the secrets of slumber, are we? Even wizards need their rest! Professor McGonagall's prescription: maintain a consistent sleep schedule (no sneaking around after curfew!), keep your chamber cool like the dungeons (60-67¬∞F), banish all caffeine potions after 2pm, try the progressive muscle relaxation charm, and take a warm bath 90 minutes before bed (works better than Sleeping Draught!). If sleep eludes you like a Niffler with gold, consult Madam Pomfrey... or a Muggle doctor!";
    }
    if (msg.includes('water') || msg.includes('hydrat')) {
      return "üíß Aguamenti! The ancient spell of hydration! Here's the wizarding wisdom: conjure a glass upon waking, infuse water with fruits (like brewing Felix Felicis, but simpler!), feast on water-rich foods (cucumber as crisp as a Mandrake, watermelon sweeter than Honeydukes candy), and use enchanted apps to track your intake. Signs you've mastered this spell: urine as pale as Nearly Headless Nick, lips as moist as a well-watered Mandrake, and energy rivaling a Patronus!";
    }
    if (msg.includes('exercise') || msg.includes('workout') || msg.includes('fitness')) {
      return "üèÉ Time to train like a Quidditch champion! Start with 10-minute walks (no need for a Firebolt yet), practice bodyweight spells like squats, push-ups, and planks, find your passion (flying on brooms... err, cycling, swimming, dancing at the Yule Ball), and schedule workouts as seriously as Defense Against the Dark Arts classes. Remember what Dumbledore always said: 'Consistency beats intensity!' Even the greatest wizards started small!";
    }
    if (msg.includes('diet') || msg.includes('food') || msg.includes('eat')) {
      return "üçΩÔ∏è Ah, the art of magical nutrition! At the Great Hall, we follow these rules: fill half your plate with vegetables (more colorful than Bertie Bott's Every Flavour Beans), choose whole grains (not just pumpkin pasties!), include lean protein worthy of a champion, eat mindfully without magical distractions, prep meals ahead like Molly Weasley, and allow occasional treats from Honeydukes. Focus on adding nutritious foods rather than restricting - even house-elves approve this approach!";
    }
    if (msg.includes('stress') || msg.includes('anxious') || msg.includes('overwhelm')) {
      return "‚ö° Facing stress more daunting than facing Voldemort? Fear not! Cast these protective charms: Practice the 4-7-8 breathing spell (inhale 4 seconds, hold like holding your wand steady for 7, exhale for 8), try 10-minute Occlumency meditation, exercise like training for the Triwizard Tournament, limit your Daily Prophet intake, maintain friendships stronger than the Golden Trio, and prioritize tasks with a Time-Turner's wisdom. Remember Harry's words: 'Help will always be given at Hogwarts to those who ask for it!' - it's okay to seek support!";
    }
    if (msg.includes('weight') || msg.includes('lose') || msg.includes('gain')) {
      return "‚öñÔ∏è Seeking body transformation magic? The Sorting Hat advises: Focus on sustainable habits, not Polyjuice Potion quick fixes! Aim for 1-2 pounds per week (slower than a Remembrall but more lasting), balance your energy like balancing on a broomstick, eat protein with every meal (even at midnight feasts!), get sleep worthy of Sleeping Beauty, and track progress beyond scales - energy levels, magical strength, how your robes fit. Remember, every wizard's body is uniquely magical!";
    }
    if (msg.includes('energy') || msg.includes('fatigue')) {
      return "‚ö° Feeling more drained than after casting a Patronus? Recharge your magical core: Get 7-9 hours in dreamland, hydrate like you're preparing for a duel, eat balanced meals with protein (better than Pepper-Up Potion!), take short walks like strolling Diagon Alley, manage stress before it summons Dementors, limit sugar and processed foods (they're like Cursed Objects for your body), and catch morning sunlight brighter than Lumos! If fatigue persists like a permanent Sticking Charm, visit your healer!";
    }
    if (msg.includes('motivation') || msg.includes('habit')) {
      return "üéØ Building habits stronger than the Room of Requirement! The ancient magic formula: Start tiny (a 2-minute version, smaller than a Pygmy Puff), anchor to existing habits like linking spells, track progress on parchment or magical devices, celebrate wins like winning the House Cup, prepare your environment better than preparing for O.W.L.s, find an accountability partner as loyal as Dobby, and show yourself the compassion Dumbledore showed Harry. Progress isn't linear - even the best wizards fall off their brooms sometimes. The magic is in getting back on!";
    }
    
    return "ü™Ñ The Sorting Hat is ready to guide you through any health quest! I possess ancient knowledge about sleep enchantments, nutrition potions, exercise spells, stress-banishing charms, hydration magic, and habit-building wizardry! Ask me specific questions like 'How can I sleep like a peaceful Hippogriff?' or 'What quick exercises can I do without a Quidditch pitch?' Remember: 'It is our choices that show what we truly are, far more than our abilities!' Choose health, young wizard!";
  };

  const handleChatSubmit = (e) => {
    e.preventDefault();
    if (!chatInput.trim()) return;
    
    setChatMessages([...chatMessages, 
      { type: 'user', text: chatInput },
      { type: 'bot', text: getAIResponse(chatInput) }
    ]);
    setChatInput('');
  };

  const healthScore = calculateHealthScore();
  const feedback = getFeedback();

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
      <div className="max-w-6xl mx-auto p-4">
        <header className="text-center py-8">
          <div className="flex items-center justify-center gap-3 mb-2">
            <Heart className="text-red-500 w-10 h-10" />
            <h1 className="text-4xl font-bold text-gray-800">Babu ne Thana thaya</h1>
          </div>
          <p className="text-gray-600">Your Personal Health & Wellness Assistant</p>
          <div className="mt-4 inline-flex items-center gap-2 px-6 py-2 bg-indigo-100 rounded-full">
            <span className="relative flex h-3 w-3">
              <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span>
              <span className="relative inline-flex rounded-full h-3 w-3 bg-indigo-500"></span>
            </span>
            <span className="text-sm font-semibold text-indigo-700">
              {visitorCount.toLocaleString()} Wizards Visited Today ‚ö°
            </span>
          </div>
        </header>

        <div className="flex gap-4 justify-center mb-6">
          <button
            onClick={() => setActiveTab('tracker')}
            className={`px-6 py-3 rounded-lg font-semibold transition-all ${
              activeTab === 'tracker'
                ? 'bg-indigo-600 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            <Activity className="inline w-5 h-5 mr-2" />
            Track Routine
          </button>
          <button
            onClick={() => setActiveTab('chat')}
            className={`px-6 py-3 rounded-lg font-semibold transition-all ${
              activeTab === 'chat'
                ? 'bg-indigo-600 text-white shadow-lg'
                : 'bg-white text-gray-700 hover:bg-gray-50'
            }`}
          >
            <MessageCircle className="inline w-5 h-5 mr-2" />
            Chat Assistant
          </button>
        </div>

        {activeTab === 'tracker' && (
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div className="bg-white rounded-2xl shadow-xl p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                <Calendar className="text-indigo-600" />
                Daily Routine Input
              </h2>
              
              <div className="space-y-6">
                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <Moon className="w-5 h-5 text-indigo-500" />
                    Sleep Hours: {routineData.sleepHours}h
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="12"
                    value={routineData.sleepHours}
                    onChange={(e) => setRoutineData({...routineData, sleepHours: parseInt(e.target.value)})}
                    className="w-full h-2 bg-indigo-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>

                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <Droplets className="w-5 h-5 text-blue-500" />
                    Water Intake: {routineData.waterIntake} glasses
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="15"
                    value={routineData.waterIntake}
                    onChange={(e) => setRoutineData({...routineData, waterIntake: parseInt(e.target.value)})}
                    className="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>

                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <Utensils className="w-5 h-5 text-green-500" />
                    Meals: {routineData.meals}
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="6"
                    value={routineData.meals}
                    onChange={(e) => setRoutineData({...routineData, meals: parseInt(e.target.value)})}
                    className="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>

                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <Activity className="w-5 h-5 text-orange-500" />
                    Exercise: {routineData.exercise} minutes
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="120"
                    step="5"
                    value={routineData.exercise}
                    onChange={(e) => setRoutineData({...routineData, exercise: parseInt(e.target.value)})}
                    className="w-full h-2 bg-orange-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>

                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <TrendingUp className="w-5 h-5 text-purple-500" />
                    Screen Time: {routineData.screenTime} hours
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="16"
                    value={routineData.screenTime}
                    onChange={(e) => setRoutineData({...routineData, screenTime: parseInt(e.target.value)})}
                    className="w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>

                <div>
                  <label className="flex items-center gap-2 text-gray-700 font-medium mb-2">
                    <Heart className="w-5 h-5 text-red-500" />
                    Stress Level: {routineData.stressLevel}/10
                  </label>
                  <input
                    type="range"
                    min="1"
                    max="10"
                    value={routineData.stressLevel}
                    onChange={(e) => setRoutineData({...routineData, stressLevel: parseInt(e.target.value)})}
                    className="w-full h-2 bg-red-200 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
              </div>

              <div className="mt-8 p-6 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl text-white">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm opacity-90">Your Health Score</p>
                    <p className="text-4xl font-bold">{healthScore}/100</p>
                  </div>
                  <Award className="w-16 h-16 opacity-80" />
                </div>
                <div className="mt-4 bg-white bg-opacity-20 rounded-full h-3 overflow-hidden">
                  <div 
                    className="bg-white h-full rounded-full transition-all duration-500"
                    style={{width: `${healthScore}%`}}
                  />
                </div>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-xl p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                <TrendingUp className="text-green-600" />
                Personalized Feedback
              </h2>
              
              <div className="space-y-4 max-h-[600px] overflow-y-auto">
                {feedback.map((item, index) => (
                  <div key={index} className="p-4 bg-gray-50 rounded-xl border-l-4 border-indigo-500">
                    <div className="flex items-start gap-3">
                      <item.icon className={`w-6 h-6 ${item.color} flex-shrink-0 mt-1`} />
                      <div>
                        <h3 className="font-bold text-gray-800 mb-1">{item.title}</h3>
                        <p className="text-gray-600 text-sm leading-relaxed">{item.text}</p>
                      </div>
                    </div>
                  </div>
                ))}
                
                <div className="p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-xl border border-green-200">
                  <h3 className="font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <Award className="w-5 h-5 text-green-600" />
                    ü™Ñ Your Daily Quest from Dumbledore
                  </h3>
                  <ul className="text-sm text-gray-700 space-y-1 ml-7">
                    <li>‚Ä¢ üåô Set a bedtime alarm (like Hogwarts curfew!)</li>
                    <li>‚Ä¢ üíß Place a water goblet on your desk</li>
                    <li>‚Ä¢ üèÉ Take a 15-minute walk through your Forbidden Forest</li>
                    <li>‚Ä¢ üì± Cast blue light shield after 8 PM</li>
                    <li>‚Ä¢ üßò Practice 5 minutes of Occlumency breathing</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        )}

        {activeTab === 'chat' && (
          <div className="bg-white rounded-2xl shadow-xl max-w-4xl mx-auto">
            <div className="p-6 border-b bg-gradient-to-r from-indigo-500 to-purple-600 rounded-t-2xl">
              <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                <MessageCircle className="w-7 h-7" />
                ü™Ñ The Sorting Hat of Health
              </h2>
              <p className="text-indigo-100 text-sm mt-1">Ask the ancient wisdom about health, wellness, and magical habit-building!</p>
            </div>
            
            <div className="h-[500px] overflow-y-auto p-6 space-y-4 bg-gray-50">
              {chatMessages.map((msg, index) => (
                <div key={index} className={`flex ${msg.type === 'user' ? 'justify-end' : 'justify-start'}`}>
                  <div className={`max-w-[80%] p-4 rounded-2xl ${
                    msg.type === 'user'
                      ? 'bg-indigo-600 text-white rounded-br-none'
                      : 'bg-white text-gray-800 shadow-md rounded-bl-none border border-gray-200'
                  }`}>
                    <p className="text-sm leading-relaxed">{msg.text}</p>
                  </div>
                </div>
              ))}
            </div>
            
            <div className="p-4 border-t bg-white rounded-b-2xl">
              <div className="flex gap-2">
                <input
                  type="text"
                  value={chatInput}
                  onChange={(e) => setChatInput(e.target.value)}
                  onKeyPress={(e) => e.key === 'Enter' && handleChatSubmit(e)}
                  placeholder="Ask about sleep, exercise, nutrition, stress..."
                  className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                />
                <button
                  onClick={handleChatSubmit}
                  className="px-6 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                >
                  Send
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

export default HealthRoutineApp;
