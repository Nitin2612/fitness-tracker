<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fitness & Mental Wellness Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
        }
        
        .tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
            font-family: inherit;
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-small {
            padding: 10px;
            margin: 5px;
            font-size: 14px;
        }
        
        .btn-share { background: #28a745; }
        .btn-download { background: #17a2b8; }
        .btn-clear { background: #dc3545; }
        .btn-profile { background: #6c757d; }
        .btn-analyze { background: #ff9800; }
        
        .results {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }
        
        .score-box {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .score-box h2 {
            font-size: 48px;
            margin-bottom: 5px;
        }
        
        .score-box p {
            font-size: 18px;
        }
        
        .metric {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .metric-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .metric-value {
            color: #666;
            font-size: 13px;
            margin-top: 5px;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 5px;
        }
        
        .status-perfect { background: #d4edda; color: #155724; }
        .status-good { background: #fff3cd; color: #856404; }
        .status-poor { background: #f8d7da; color: #721c24; }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0 10px 0;
        }
        
        .achievement {
            background: #d4edda;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            color: #155724;
        }
        
        .improvement {
            background: #fff3cd;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            color: #856404;
        }
        
        .recommendation {
            background: #e7f3ff;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            color: #004085;
            border-left: 4px solid #004085;
        }
        
        .day-info {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
            background: white;
            padding: 15px;
            border-radius: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn-group button {
            flex: 1;
            min-width: 100px;
        }
        
        .info-box {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        
        .info-box h3 {
            color: #004085;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .info-box p {
            color: #004085;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .mental-health-scale {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
        }
        
        .scale-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            margin: 0 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            background: #f0f0f0;
            transition: all 0.3s;
        }
        
        .scale-item:hover {
            background: #e0e0e0;
        }
        
        .scale-item.selected {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .ai-feedback {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
            border-radius: 10px;
            color: white;
            margin: 15px 0;
        }
        
        .ai-feedback h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .ai-feedback p {
            font-size: 14px;
            line-height: 1.6;
        }
        
        .profile-setup {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .hidden {
            display: none;
        }
        
        .nutrition-targets {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #667eea;
        }
        
        .nutrition-targets h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .nutrition-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            font-size: 14px;
        }
        
        .food-analyzer {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px dashed #ff9800;
        }
        
        .food-result {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }
        
        .food-result h4 {
            color: #28a745;
            margin-bottom: 10px;
        }
        
        .nutrition-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .nutrition-summary div {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        
        .nutrition-summary strong {
            display: block;
            font-size: 20px;
            color: #667eea;
            margin-top: 5px;
        }
        
        .food-list {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí™ Babu Ne Thana Thaya</h1>
        <div style="text-align: center; color: #667eea; font-size: 12px; margin-bottom: 15px;">
            üë• Visitors: <strong id="visitorCount">0</strong>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('tracker')">üìù Daily</button>
            <button class="tab" onclick="switchTab('profile')">üë§ Profile</button>
            <button class="tab" onclick="switchTab('analytics')">üìä Analytics</button>
            <button class="tab" onclick="switchTab('ai-coach')">ü§ñ AI Coach</button>
        </div>
        
        <!-- PROFILE SETUP TAB -->
        <div id="profile" class="tab-content">
            <h2 style="color: #667eea; margin-bottom: 15px;">Personal Profile</h2>
            
            <div class="input-group">
                <label>‚ößÔ∏è Gender</label>
                <select id="profileGender" onchange="saveProfile()">
                    <option value="">Select gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>üìè Height (cm)</label>
                <input type="number" id="profileHeight" placeholder="e.g., 183" onchange="saveProfile()">
            </div>
            
            <div class="input-group">
                <label>‚öñÔ∏è Current Weight (kg)</label>
                <input type="number" id="profileWeight" placeholder="e.g., 87" onchange="saveProfile()">
            </div>
            
            <div class="input-group">
                <label>üéØ Target Weight (kg)</label>
                <input type="number" id="profileTargetWeight" placeholder="e.g., 75" onchange="saveProfile()">
            </div>
            
            <div class="input-group">
                <label>üéÇ Age (years)</label>
                <input type="number" id="profileAge" placeholder="e.g., 25" onchange="saveProfile()">
            </div>
            
            <div class="input-group">
                <label>üèÉ Activity Level</label>
                <select id="profileActivity" onchange="saveProfile()">
                    <option value="">Select activity level</option>
                    <option value="sedentary">Sedentary (little/no exercise)</option>
                    <option value="light">Light (1-3 days/week)</option>
                    <option value="moderate">Moderate (3-5 days/week)</option>
                    <option value="active">Active (6-7 days/week)</option>
                    <option value="very_active">Very Active (athlete/physical job)</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>üéØ Primary Goal</label>
                <select id="profileGoal" onchange="saveProfile()">
                    <option value="">Select goal</option>
                    <option value="weight_loss">Weight Loss</option>
                    <option value="muscle_gain">Muscle Gain</option>
                    <option value="maintenance">Maintenance</option>
                    <option value="athletic">Athletic Performance</option>
                </select>
            </div>
            
            <div id="nutritionTargets" class="nutrition-targets hidden">
                <h4>üìä Your Personalized Nutrition Targets</h4>
                <div class="nutrition-item">
                    <span>Daily Calories:</span>
                    <strong id="targetCalories">-</strong>
                </div>
                <div class="nutrition-item">
                    <span>Protein:</span>
                    <strong id="targetProtein">-</strong>
                </div>
                <div class="nutrition-item">
                    <span>Carbs:</span>
                    <strong id="targetCarbs">-</strong>
                </div>
                <div class="nutrition-item">
                    <span>Fats:</span>
                    <strong id="targetFats">-</strong>
                </div>
                <p style="margin-top: 10px; font-size: 12px; color: #666;">
                    <em>* Based on WHO/AND guidelines and adjusted for your workout type</em>
                </p>
            </div>
            
            <button class="btn" onclick="switchTab('tracker')">‚úÖ Save & Start Tracking</button>
        </div>
        
        <!-- DAILY TRACKER TAB -->
        <div id="tracker" class="tab-content active">
            <div class="day-info" id="dayInfo"></div>
            
            <div id="profileWarning" class="info-box">
                <h3>‚ö†Ô∏è Setup Required</h3>
                <p>Please complete your profile first for personalized nutrition targets and AI recommendations.</p>
                <button class="btn btn-small btn-profile" onclick="switchTab('profile')">Complete Profile</button>
            </div>
            
            <div class="btn-group">
                <button onclick="shareApp()" class="btn btn-small btn-share">üì§ Share</button>
                <button onclick="saveReport()" class="btn btn-small btn-download">üíæ Report</button>
                <button onclick="clearData()" class="btn btn-small btn-clear">üóëÔ∏è Clear</button>
            </div>
            
            <form id="trackerForm">
                <!-- FOOD ANALYZER -->
                <div class="food-analyzer">
                    <h3 style="color: #ff9800; margin-bottom: 10px;">üçΩÔ∏è Food Analyzer</h3>
                    <p style="font-size: 13px; margin-bottom: 10px; color: #666;">
                        List everything you ate today, separated by commas
                    </p>
                    <div class="input-group">
                        <label>What did you eat today?</label>
                        <textarea id="foodInput" placeholder="e.g., 2 boiled eggs, 1 cup oats, 100g chicken breast, 1 apple, 2 roti, dal, brown rice, paneer bhurji"></textarea>
                    </div>
                    <button type="button" class="btn btn-small btn-analyze" onclick="analyzeFoodNutrition()">üîç Analyze Nutrition</button>
                    
                    <div id="foodAnalysisResult" class="food-result hidden">
                        <h4>üìä Nutrition Analysis</h4>
                        <div class="nutrition-summary">
                            <div>
                                <span style="font-size: 12px; color: #666;">Calories</span>
                                <strong id="analyzedCalories">0</strong>
                                <span style="font-size: 11px;">kcal</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #666;">Protein</span>
                                <strong id="analyzedProtein">0</strong>
                                <span style="font-size: 11px;">g</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #666;">Carbs</span>
                                <strong id="analyzedCarbs">0</strong>
                                <span style="font-size: 11px;">g</span>
                            </div>
                            <div>
                                <span style="font-size: 12px; color: #666;">Fats</span>
                                <strong id="analyzedFats">0</strong>
                                <span style="font-size: 11px;">g</span>
                            </div>
                        </div>
                        <div class="food-list">
                            <strong>Items detected:</strong>
                            <div id="foodItems"></div>
                        </div>
                        <button type="button" class="btn btn-small" onclick="useFoodAnalysis()">‚úÖ Use These Values</button>
                    </div>
                </div>
                
                <!-- MANUAL NUTRITION ENTRY -->
                <div class="section-title">Or Enter Manually</div>
                
                <div class="input-group">
                    <label>üçΩÔ∏è Calories (kcal)</label>
                    <input type="number" id="calories" placeholder="e.g., 1850" required>
                </div>
                
                <div class="input-group">
                    <label>üí™ Protein (g)</label>
                    <input type="number" id="protein" placeholder="e.g., 165" required>
                </div>
                
                <div class="input-group">
                    <label>üçö Carbs (g)</label>
                    <input type="number" id="carbs" placeholder="e.g., 140" required>
                </div>
                
                <div class="input-group">
                    <label>ü•ë Fats (g)</label>
                    <input type="number" id="fats" placeholder="e.g., 50" required>
                </div>
                
                <div class="input-group">
                    <label>üíß Water (liters)</label>
                    <input type="number" step="0.1" id="water" placeholder="e.g., 3.5" required>
                </div>
                
                <div class="input-group">
                    <label>üò¥ Sleep (hours)</label>
                    <input type="number" step="0.5" id="sleep" placeholder="e.g., 7.5" required>
                </div>
                
                <div class="input-group">
                    <label>üèãÔ∏è Workout Completed?</label>
                    <select id="workout" onchange="toggleWorkoutType()">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </div>
                
                <div class="input-group" id="workoutTypeGroup">
                    <label>üí™ Workout Type</label>
                    <select id="workoutType">
                        <option value="">Select workout type</option>
                        <option value="strength">Strength Training</option>
                        <option value="cardio">Cardio/Running</option>
                        <option value="hiit">HIIT</option>
                        <option value="yoga">Yoga/Flexibility</option>
                        <option value="sports">Sports</option>
                        <option value="mixed">Mixed/Full Body</option>
                    </select>
                </div>
                
                <div class="input-group" id="workoutDurationGroup">
                    <label>‚è±Ô∏è Workout Duration (minutes)</label>
                    <input type="number" id="workoutDuration" placeholder="e.g., 45" min="0">
                </div>
                
                <div class="input-group">
                    <label>üìö Study/Work Time (hours)</label>
                    <input type="number" step="0.5" id="study" placeholder="e.g., 3" required>
                </div>
                
                <div class="section-title">üß† Mental Health Check</div>
                
                <div class="input-group">
                    <label>üòä Overall Mood (1-10)</label>
                    <div class="mental-health-scale" id="moodScale">
                        <div class="scale-item" onclick="selectScale('mood', 1)">1<br>üò¢</div>
                        <div class="scale-item" onclick="selectScale('mood', 2)">2</div>
                        <div class="scale-item" onclick="selectScale('mood', 3)">3</div>
                        <div class="scale-item" onclick="selectScale('mood', 4)">4</div>
                        <div class="scale-item" onclick="selectScale('mood', 5)">5<br>üòê</div>
                        <div class="scale-item" onclick="selectScale('mood', 6)">6</div>
                        <div class="scale-item" onclick="selectScale('mood', 7)">7</div>
                        <div class="scale-item" onclick="selectScale('mood', 8)">8</div>
                        <div class="scale-item" onclick="selectScale('mood', 9)">9</div>
                        <div class="scale-item" onclick="selectScale('mood', 10)">10<br>üòÑ</div>
                    </div>
                    <input type="hidden" id="mood" required>
                </div>
                
                <div class="input-group">
                    <label>üò∞ Stress Level (1-10)</label>
                    <div class="mental-health-scale" id="stressScale">
                        <div class="scale-item" onclick="selectScale('stress', 1)">1<br>üòå</div>
                        <div class="scale-item" onclick="selectScale('stress', 2)">2</div>
                        <div class="scale-item" onclick="selectScale('stress', 3)">3</div>
                        <div class="scale-item" onclick="selectScale('stress', 4)">4</div>
                        <div class="scale-item" onclick="selectScale('stress', 5)">5<br>üòê</div>
                        <div class="scale-item" onclick="selectScale('stress', 6)">6</div>
                        <div class="scale-item" onclick="selectScale('stress', 7)">7</div>
                        <div class="scale-item" onclick="selectScale('stress', 8)">8</div>
                        <div class="scale-item" onclick="selectScale('stress', 9)">9</div>
                        <div class="scale-item" onclick="selectScale('stress', 10)">10<br>üò´</div>
                    </div>
                    <input type="hidden" id="stress" required>
                </div>
                
                <div class="input-group">
                    <label>‚ö° Energy Level (1-10)</label>
                    <div class="mental-health-scale" id="energyScale">
                        <div class="scale-item" onclick="selectScale('energy', 1)">1<br>üîã</div>
                        <div class="scale-item" onclick="selectScale('energy', 2)">2</div>
                        <div class="scale-item" onclick="selectScale('energy', 3)">3</div>
                        <div class="scale-item" onclick="selectScale('energy', 4)">4</div>
                        <div class="scale-item" onclick="selectScale('energy', 5)">5<br>‚ö°</div>
                        <div class="scale-item" onclick="selectScale('energy', 6)">6</div>
                        <div class="scale-item" onclick="selectScale('energy', 7)">7</div>
                        <div class="scale-item" onclick="selectScale('energy', 8)">8</div>
                        <div class="scale-item" onclick="selectScale('energy', 9)">9</div>
                        <div class="scale-item" onclick="selectScale('energy', 10)">10<br>‚ö°‚ö°</div>
                    </div>
                    <input type="hidden" id="energy" required>
                </div>
                
                <div class="input-group">
                    <label>üí≠ How are you feeling today? (Optional)</label>
                    <textarea id="feelings" placeholder="Share your thoughts, challenges, or wins"></textarea>
                </div>
                
                <button type="submit" class="btn">üöÄ Analyze My Day</button>
            </form>
            
            <div class="results" id="results"></div>
        </div>
        
        <!-- ANALYTICS TAB -->
        <div id="analytics" class="tab-content">
            <div id="analyticsContent"></div>
        </div>
        
        <!-- AI COACH TAB -->
        <div id="ai-coach" class="tab-content">
            <div id="aiCoachContent">
                <div class="no-data">ü§ñ Complete at least one day of tracking to receive AI-powered insights!</div>
            </div>
        </div>
    </div>

    <script>
        let userProfile = {};
        let selectedScales = { mood: null, stress: null, energy: null };
        let charts = {};
        
        // Comprehensive food database with nutrition per 100g/100ml or per item
        const foodDatabase = {
            // Eggs & Dairy
            'egg': { name: 'Egg (1 whole)', calories: 78, protein: 6, carbs: 0.6, fats: 5, unit: 'piece' },
            'egg white': { name: 'Egg White (1)', calories: 17, protein: 3.6, carbs: 0.2, fats: 0.1, unit: 'piece' },
            'egg yolk': { name: 'Egg Yolk (1)', calories: 55, protein: 2.7, carbs: 0.6, fats: 4.5, unit: 'piece' },
            'boiled egg': { name: 'Boiled Egg (1)', calories: 78, protein: 6, carbs: 0.6, fats: 5, unit: 'piece' },
            'paneer': { name: 'Paneer', calories: 265, protein: 18, carbs: 1.2, fats: 20, unit: '100g' },
            'milk': { name: 'Milk', calories: 42, protein: 3.4, carbs: 5, fats: 1, unit: '100ml' },
            'curd': { name: 'Curd/Yogurt', calories: 60, protein: 3.5, carbs: 4.7, fats: 3.3, unit: '100g' },
            'yogurt': { name: 'Yogurt', calories: 60, protein: 3.5, carbs: 4.7, fats: 3.3, unit: '100g' },
            'cheese': { name: 'Cheese', calories: 402, protein: 25, carbs: 1.3, fats: 33, unit: '100g' },
            
            // Grains & Bread
            'rice': { name: 'Cooked Rice', calories: 130, protein: 2.7, carbs: 28, fats: 0.3, unit: '100g' },
            'brown rice': { name: 'Brown Rice', calories: 112, protein: 2.6, carbs: 24, fats: 0.9, unit: '100g' },
            'roti': { name: 'Roti (1 medium)', calories: 71, protein: 3, carbs: 15, fats: 0.4, unit: 'piece' },
            'chapati': { name: 'Chapati (1)', calories: 71, protein: 3, carbs: 15, fats: 0.4, unit: 'piece' },
            'bread': { name: 'Bread (1 slice)', calories: 80, protein: 4, carbs: 14, fats: 1, unit: 'slice' },
            'oats': { name: 'Oats', calories: 389, protein: 17, carbs: 67, fats: 7, unit: '100g' },
            
            // Meat & Protein
            'chicken': { name: 'Chicken Breast', calories: 165, protein: 31, carbs: 0, fats: 3.6, unit: '100g' },
            'chicken breast': { name: 'Chicken Breast', calories: 165, protein: 31, carbs: 0, fats: 3.6, unit: '100g' },
            'fish': { name: 'Fish', calories: 100, protein: 20, carbs: 0, fats: 1, unit: '100g' },
            'meat': { name: 'Lean Meat', calories: 250, protein: 26, carbs: 0, fats: 15, unit: '100g' },
            'mutton': { name: 'Mutton', calories: 294, protein: 25, carbs: 0, fats: 21, unit: '100g' },
            
            // Legumes & Dal
            'dal': { name: 'Dal (cooked)', calories: 101, protein: 9, carbs: 18, fats: 0.3, unit: '100g' },
            'lentils': { name: 'Lentils (cooked)', calories: 116, protein: 9, carbs: 20, fats: 0.4, unit: '100g' },
            'chickpeas': { name: 'Chickpeas', calories: 164, protein: 9, carbs: 27, fats: 3, unit: '100g' },
            'beans': { name: 'Beans', calories: 127, protein: 9, carbs: 23, fats: 0.5, unit: '100g' },
            
            // Vegetables
            'spinach': { name: 'Spinach', calories: 23, protein: 2.7, carbs: 3.6, fats: 0.4, unit: '100g' },
            'broccoli': { name: 'Broccoli', calories: 34, protein: 2.8, carbs: 7, fats: 0.4, unit: '100g' },
            'carrot': { name: 'Carrot', calories: 41, protein: 0.9, carbs: 10, fats: 0.2, unit: '100g' },
            'tomato': { name: 'Tomato', calories: 18, protein: 0.9, carbs: 3.9, fats: 0.2, unit: '100g' },
            'onion': { name: 'Onion', calories: 40, protein: 1.1, carbs: 9, fats: 0.1, unit: '100g' },
            'cucumber': { name: 'Cucumber', calories: 16, protein: 0.7, carbs: 3.6, fats: 0.1, unit: '100g' },
            'potato': { name: 'Potato (boiled)', calories: 77, protein: 2, carbs: 17, fats: 0.1, unit: '100g' },
            'sweet potato': { name: 'Sweet Potato', calories: 86, protein: 1.6, carbs: 20, fats: 0.1, unit: '100g' },
            
            // Fruits
            'apple': { name: 'Apple (1 medium)', calories: 95, protein: 0.5, carbs: 25, fats: 0.3, unit: 'piece' },
            'banana': { name: 'Banana (1 medium)', calories: 105, protein: 1.3, carbs: 27, fats: 0.3, unit: 'piece' },
            'orange': { name: 'Orange (1 medium)', calories: 62, protein: 1.2, carbs: 15, fats: 0.3, unit: 'piece' },
            'papaya': { name: 'Papaya', calories: 43, protein: 0.5, carbs: 11, fats: 0.3, unit: '100g' },
            'mango': { name: 'Mango', calories: 60, protein: 0.8, carbs: 15, fats: 0.4, unit: '100g' },
            'grapes': { name: 'Grapes', calories: 67, protein: 0.7, carbs: 17, fats: 0.2, unit: '100g' },
            'watermelon': { name: 'Watermelon', calories: 30, protein: 0.6, carbs: 7.6, fats: 0.2, unit: '100g' },
            
            // Nuts & Seeds
            'almond': { name: 'Almonds', calories: 579, protein: 21, carbs: 22, fats: 50, unit: '100g' },
            'peanut': { name: 'Peanuts', calories: 567, protein: 26, carbs: 16, fats: 49, unit: '100g' },
            'peanut butter': { name: 'Peanut Butter', calories: 595, protein: 25, carbs: 21, fats: 50, unit: '100g' },
            'walnut': { name: 'Walnuts', calories: 654, protein: 15, carbs: 14, fats: 65, unit: '100g' },
            'chana': { name: 'Roasted Chana', calories: 364, protein: 19, carbs: 58, fats: 7, unit: '100g' },
            
            // Oils & Fats
            'oil': { name: 'Oil/Ghee', calories: 884, protein: 0, carbs: 0, fats: 100, unit: '10ml' },
            'ghee': { name: 'Ghee', calories: 884, protein: 0, carbs: 0, fats: 100, unit: '10ml' },
            'butter': { name: 'Butter', calories: 717, protein: 0.9, carbs: 0.1, fats: 81, unit: '10g' },
            
            // Other
            'tea': { name: 'Tea (unsweetened)', calories: 2, protein: 0.3, carbs: 0.3, fats: 0, unit: '100ml' },
            'coffee': { name: 'Coffee (unsweetened)', calories: 0, protein: 0.1, carbs: 0, fats: 0, unit: '100ml' },
            'honey': { name: 'Honey', calories: 304, protein: 0.3, carbs: 82, fats: 0, unit: '100g' },
            'sugar': { name: 'Sugar', calories: 387, protein: 0, carbs: 100, fats: 0, unit: '100g' },
            'salt': { name: 'Salt', calories: 0, protein: 0, carbs: 0, fats: 0, unit: '1g' }
        };

        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const today = days[new Date().getDay()];

        window.onload = function() {
            loadProfile();
            updateDayInfo();
            checkProfileStatus();
            toggleWorkoutType();
            updateVisitorCount();
        };

        function updateDayInfo() {
            document.getElementById('dayInfo').textContent = 
                `üìÖ ${new Date().toLocaleDateString()} (${today})`;
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        }

        function updateVisitorCount() {
            let count = localStorage.getItem('visitorCount') || 0;
            count = parseInt(count) + 1;
            localStorage.setItem('visitorCount', count);
            document.getElementById('visitorCount').textContent = count;
        }

        function loadProfile() {
            const saved = localStorage.getItem('userProfile');
            if (saved) {
                userProfile = JSON.parse(saved);
                document.getElementById('profileGender').value = userProfile.gender || '';
                document.getElementById('profileHeight').value = userProfile.height || '';
                document.getElementById('profileWeight').value = userProfile.weight || '';
                document.getElementById('profileTargetWeight').value = userProfile.targetWeight || '';
                document.getElementById('profileAge').value = userProfile.age || '';
                document.getElementById('profileActivity').value = userProfile.activity || '';
                document.getElementById('profileGoal').value = userProfile.goal || '';
            }
        }

        function saveProfile() {
            userProfile = {
                gender: document.getElementById('profileGender').value,
                height: parseFloat(document.getElementById('profileHeight').value) || 0,
                weight: parseFloat(document.getElementById('profileWeight').value) || 0,
                targetWeight: parseFloat(document.getElementById('profileTargetWeight').value) || 0,
                age: parseInt(document.getElementById('profileAge').value) || 0,
                activity: document.getElementById('profileActivity').value,
                goal: document.getElementById('profileGoal').value
            };
            
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            calculateNutritionTargets();
            checkProfileStatus();
        }

        function calculateNutritionTargets() {
            if (!userProfile.gender || !userProfile.weight || !userProfile.height || !userProfile.age) {
                return;
            }

            let bmr;
            if (userProfile.gender === 'male') {
                bmr = (10 * userProfile.weight) + (6.25 * userProfile.height) - (5 * userProfile.age) + 5;
            } else {
                bmr = (10 * userProfile.weight) + (6.25 * userProfile.height) - (5 * userProfile.age) - 161;
            }

            const activityMultipliers = {
                sedentary: 1.2,
                light: 1.375,
                moderate: 1.55,
                active: 1.725,
                very_active: 1.9
            };
            
            const tdee = bmr * (activityMultipliers[userProfile.activity] || 1.55);
            
            let targetCalories = tdee;
            if (userProfile.goal === 'weight_loss') {
                targetCalories = tdee - 500;
            } else if (userProfile.goal === 'muscle_gain') {
                targetCalories = tdee + 300;
            }

            let proteinGrams, carbsGrams, fatsGrams;
            
            if (userProfile.gender === 'male') {
                proteinGrams = userProfile.weight * 2.0;
                fatsGrams = (targetCalories * 0.25) / 9;
                carbsGrams = (targetCalories - (proteinGrams * 4) - (fatsGrams * 9)) / 4;
            } else {
                proteinGrams = userProfile.weight * 1.6;
                fatsGrams = (targetCalories * 0.30) / 9;
                carbsGrams = (targetCalories - (proteinGrams * 4) - (fatsGrams * 9)) / 4;
            }

            userProfile.targets = {
                calories: Math.round(targetCalories),
                protein: Math.round(proteinGrams),
                carbs: Math.round(carbsGrams),
                fats: Math.round(fatsGrams),
                water: userProfile.gender === 'male' ? 3.7 : 2.7,
                sleep: 8
            };

            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            displayNutritionTargets();
        }

        function displayNutritionTargets() {
            if (!userProfile.targets) return;
            
            const targetsDiv = document.getElementById('nutritionTargets');
            targetsDiv.classList.remove('hidden');
            document.getElementById('targetCalories').textContent = `${userProfile.targets.calories} kcal`;
            document.getElementById('targetProtein').textContent = `${userProfile.targets.protein}g`;
            document.getElementById('targetCarbs').textContent = `${userProfile.targets.carbs}g`;
            document.getElementById('targetFats').textContent = `${userProfile.targets.fats}g`;
        }

        function checkProfileStatus() {
            const warning = document.getElementById('profileWarning');
            if (userProfile.gender && userProfile.weight && userProfile.height && userProfile.age) {
                warning.classList.add('hidden');
            } else {
                warning.classList.remove('hidden');
            }
        }

        function analyzeFoodNutrition() {
            const foodInput = document.getElementById('foodInput').value.trim();
            if (!foodInput) {
                alert('Please enter what you ate');
                return;
            }

            const items = foodInput.split(',').map(item => item.trim().toLowerCase());
            let totalCalories = 0, totalProtein = 0, totalCarbs = 0, totalFats = 0;
            const foundItems = [];

            items.forEach(item => {
                if (!item) return;
                
                // Try to find quantity (e.g., "2 eggs" or "100g chicken")
                const quantityMatch = item.match(/^(\d+(?:\.\d+)?)\s*(g|ml|cup|piece|slice)?/);
                let quantity = 1;
                let unit = 'piece';
                let foodName = item;

                if (quantityMatch) {
                    quantity = parseFloat(quantityMatch[1]);
                    if (quantityMatch[2]) {
                        unit = quantityMatch[2];
                    }
                    foodName = item.substring(quantityMatch[0].length).trim();
                }

                // Search for food in database
                let found = false;
                for (const [key, food] of Object.entries(foodDatabase)) {
                    if (foodName.includes(key) || key.includes(foodName)) {
                        let multiplier = quantity;
                        
                        // Convert units
                        if (food.unit === '100g' || food.unit === '100ml') {
                            if (unit === 'g') multiplier = quantity / 100;
                            else if (unit === 'ml') multiplier = quantity / 100;
                        } else if (food.unit === '10ml') {
                            if (unit === 'ml') multiplier = quantity / 10;
                        }

                        totalCalories += food.calories * multiplier;
                        totalProtein += food.protein * multiplier;
                        totalCarbs += food.carbs * multiplier;
                        totalFats += food.fats * multiplier;
                        
                        foundItems.push(`${quantity}${unit} ${food.name}`);
                        found = true;
                        break;
                    }
                }

                if (!found) {
                    foundItems.push(`‚ùì ${item} (not found - add manually)`);
                }
            });

            document.getElementById('analyzedCalories').textContent = Math.round(totalCalories);
            document.getElementById('analyzedProtein').textContent = Math.round(totalProtein);
            document.getElementById('analyzedCarbs').textContent = Math.round(totalCarbs);
            document.getElementById('analyzedFats').textContent = Math.round(totalFats);
            document.getElementById('foodItems').textContent = foundItems.join(' | ');
            
            document.getElementById('foodAnalysisResult').classList.remove('hidden');
        }

        function useFoodAnalysis() {
            document.getElementById('calories').value = document.getElementById('analyzedCalories').textContent;
            document.getElementById('protein').value = document.getElementById('analyzedProtein').textContent;
            document.getElementById('carbs').value = document.getElementById('analyzedCarbs').textContent;
            document.getElementById('fats').value = document.getElementById('analyzedFats').textContent;
            alert('‚úÖ Values added! Continue filling other fields.');
        }

        function toggleWorkoutType() {
            const workout = document.getElementById('workout').value;
            const workoutTypeGroup = document.getElementById('workoutTypeGroup');
            const workoutDurationGroup = document.getElementById('workoutDurationGroup');
            
            if (workout === 'yes') {
                workoutTypeGroup.style.display = 'block';
                workoutDurationGroup.style.display = 'block';
            } else {
                workoutTypeGroup.style.display = 'none';
                workoutDurationGroup.style.display = 'none';
            }
        }

        function selectScale(type, value) {
            document.getElementById(type).value = value;
            const items = document.getElementById(type + 'Scale').querySelectorAll('.scale-item');
            items.forEach(item => item.classList.remove('selected'));
            items[value - 1].classList.add('selected');
        }

        document.getElementById('trackerForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const data = {
                date: new Date().toISOString(),
                calories: parseFloat(document.getElementById('calories').value),
                protein: parseFloat(document.getElementById('protein').value),
                carbs: parseFloat(document.getElementById('carbs').value),
                fats: parseFloat(document.getElementById('fats').value),
                water: parseFloat(document.getElementById('water').value),
                sleep: parseFloat(document.getElementById('sleep').value),
                workout: document.getElementById('workout').value === 'yes',
                workoutType: document.getElementById('workoutType').value,
                workoutDuration: parseFloat(document.getElementById('workoutDuration').value) || 0,
                study: parseFloat(document.getElementById('study').value),
                mood: parseInt(document.getElementById('mood').value),
                stress: parseInt(document.getElementById('stress').value),
                energy: parseInt(document.getElementById('energy').value),
                feelings: document.getElementById('feelings').value
            };

            // Calculate overall score
            let score = 0;
            const targets = userProfile.targets || { calories: 1900, protein: 170, carbs: 140, fats: 50, water: 3.5, sleep: 8 };
            
            score += Math.min(100, (data.calories / targets.calories) * 100 * 0.8 + 20);
            score += Math.min(100, (data.protein / targets.protein) * 100 * 0.8 + 20);
            score += Math.min(100, (data.sleep / targets.sleep) * 100 * 0.8 + 20);
            score += data.mood * 10;
            score += (11 - data.stress) * 10;
            score += data.energy * 10;
            score += (data.workout ? 100 : 0);
            score = score / 7;

            data.score = Math.round(score);

            let html = `
                <div class="score-box">
                    <h2>${data.score}/100</h2>
                    <p>Today's Score</p>
                </div>

                <div class="section-title">üìä Today's Nutrition</div>
                <div class="metric">
                    <div class="metric-title">üçΩÔ∏è Calories: ${data.calories} kcal</div>
                    <div class="metric-value">Target: ${targets.calories}${data.calories >= targets.calories * 0.95 && data.calories <= targets.calories * 1.05 ? ' ‚úÖ' : ' ‚ö†Ô∏è'}</div>
                </div>
                <div class="metric">
                    <div class="metric-title">üí™ Protein: ${data.protein}g</div>
                    <div class="metric-value">Target: ${targets.protein}g${data.protein >= targets.protein * 0.95 && data.protein <= targets.protein * 1.05 ? ' ‚úÖ' : ' ‚ö†Ô∏è'}</div>
                </div>
                <div class="metric">
                    <div class="metric-title">üçö Carbs: ${data.carbs}g</div>
                    <div class="metric-value">Target: ${targets.carbs}g</div>
                </div>
                <div class="metric">
                    <div class="metric-title">ü•ë Fats: ${data.fats}g</div>
                    <div class="metric-value">Target: ${targets.fats}g</div>
                </div>

                <div class="section-title">üß† Mental Wellness</div>
                <div class="metric">
                    <div class="metric-title">üòä Mood: ${data.mood}/10</div>
                </div>
                <div class="metric">
                    <div class="metric-title">üò∞ Stress: ${data.stress}/10</div>
                </div>
                <div class="metric">
                    <div class="metric-title">‚ö° Energy: ${data.energy}/10</div>
                </div>

                <div class="section-title">üí™ Fitness</div>
                <div class="metric">
                    <div class="metric-title">üèãÔ∏è Workout: ${data.workout ? `‚úÖ ${data.workoutType} (${data.workoutDuration} min)` : '‚ùå Not Done'}</div>
                </div>
                <div class="metric">
                    <div class="metric-title">üìö Study: ${data.study} hours</div>
                </div>
            `;

            document.getElementById('results').innerHTML = html;
            document.getElementById('results').style.display = 'block';

            const history = JSON.parse(localStorage.getItem('progressHistory') || '[]');
            history.push(data);
            localStorage.setItem('progressHistory', JSON.stringify(history.slice(-30)));

            document.getElementById('trackerForm').reset();
            document.getElementById('foodAnalysisResult').classList.add('hidden');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });

        function shareApp() {
            const shareText = `üéØ AI Fitness & Wellness Tracker - Track Nutrition, Workouts & Mental Health!\n\nFeatures:\n‚úÖ Smart Food Analyzer\n‚úÖ Personalized Nutrition\n‚úÖ Mental Health Tracking\n‚úÖ AI-Powered Insights\n\nTry it now!`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'AI Fitness Tracker',
                    text: shareText
                });
            } else {
                navigator.clipboard.writeText(shareText);
                alert('‚úÖ Link copied!');
            }
        }

        function saveReport() {
            const results = document.getElementById('results').innerText;
            if (!results) {
                alert('‚ö†Ô∏è Please complete tracking first!');
                return;
            }
            const blob = new Blob([results], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fitness-report-${new Date().toLocaleDateString().replace(/\//g, '-')}.txt`;
            a.click();
        }

        function clearData() {
            if (confirm('‚ö†Ô∏è Delete all progress data?')) {
                localStorage.removeItem('progressHistory');
                alert('‚úÖ Data cleared!');
                location.reload();
            }
        }
    </script>
</body>
</html>
